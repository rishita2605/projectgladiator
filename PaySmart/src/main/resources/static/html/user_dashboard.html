<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	if (sessionStorage.getItem("customer_username") === null)
		history.go(-1);
	else
		alert("Logged in as : "+sessionStorage.getItem("customer_username"));
	
	var obj = {
			username : sessionStorage.getItem("customer_username")
	}
	
	$.ajax({
			url : '/get.card.details',
			method : 'POST',
			data : JSON.stringify(obj),
			contentType : 'application/json',
			
			success : function(response){
				//alert(JSON.stringify(response));
				$("#card_number").append(response.cardno);
				$("#card_name").append(response.name);
				$("#card_type").append(response.type);
				$("#card_status").append(response.cardstatus);
			}
		})
	$(document).on("click","#pressthis",function(){
		
		alert("This is going fine");
		var user_name = sessionStorage.getItem("customer_username");
		alert(user_name);
		
		var url = "/fetch.all.orders?user_name="+user_name
	
		$.ajax({
			url : url,
			method : 'GET',
			type : 'json',
			
			success : function(response){
				alert(JSON.stringify(response));
				$.each(response, function(i, orderdetails) {
					var row = $('<tr/>');
					var column1 = $('<td/>').text(orderdetails.productname);
					var column2 = $("<td/>").text(orderdetails.orderdate);
					var column3 = $("<td/>").text(orderdetails.emischeme);
					var column4 = $("<td/>").text(orderdetails.paymentid); 
			 		var column5 = $("<td/>").text(orderdetails.totalinstallments);
			 		var column6 = $("<td/>").text(orderdetails.paidinstallments); 
			 		var column7 = $("<td/>").text(orderdetails.installmentvalue);
			 		var column8 = $("<td/>").text(orderdetails.last_paiddate); 
			 		var column9 = $("<td/>").text(orderdetails.next_paydate);
			 		var column10 = $("<td/>").text(orderdetails.paymentstatus); 


			 		/* var column6 = $("<td/>");
			 		var img = $("<img/>").attr("src","../uploads/"+user.aadharfile);
			 		column6.append(img);
			 		var column7 = $("<td/>");
			 		var img = $("<img/>").attr("src","../uploads/"+user.panfile);
			 		column6.append(img); */
			 		
			 		/* var column6 = $("<td/>").html('<a href="../uploads/'+user.aadharfile+'">View Aadhar</a>');
			 		var column7 = $("<td/>").html('<a href="../uploads/'+user.panfile+'">View Pan</a>'); */
			 		
			 		var r = $('<button class="makepament" value='+orderdetails.paymentid+'>Make Payment</button>');
			 		
					row.append(column1);
					row.append(column2);
					row.append(column3); 
					row.append(column4);
					row.append(column5);
					row.append(column6);
					row.append(column7);
					row.append(column8);
					row.append(column9);
					row.append(column10);
					row.append(r);
					$('#order_table').append(row);
				})
				
				
				
			}
			
		})
	})
})
</script>
<body>
<h1 align="center">DASHBOARD</h1>
<div>
<label>Card Number :</label> <label id="card_number"></label> <br/>
<label>Card Holder Name :</label> <label id="card_name"></label> <br/>
<label>Type of Card :</label> <label id="card_type"></label><br/>
<label>Status:</label> <label id="card_status"></label><br/>
<div class=topupcard"">
<button class="rechargecard" id="rechargecard">Recharge Card</button>
</div>
</div>
<div class="show_order_button">
<button class="showorder" id="pressthis">Show orders</button>
</div>
<div class="table_div">
<table id="order_table"  style="border : 1px solid black;">
<tr style="border : 1px solid black;">
</tr>
</table>
</div>
</body>
</html>